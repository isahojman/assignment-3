---
title: "Assignment 3"
author: "Isabel Hojman"
date: "15/11/2017"
output: html_document
---

```{r}
source("Functions.R")
```

# Exercise 1

```{r}
`%>%` <- magrittr::`%>%`
#library(dplyr)
```

## Task A

```{r}
#print(stressshift::stress_shift_unamb)
stress_shift_3dict <- dplyr::filter(stressshift::stress_shift_unamb, Dict %in% c("W1802", "J1917", "C1687")) 
print(stress_shift_3dict)
print(dim(stress_shift_3dict))
```


## Task B

```{r}
stress_shift_3dict_using_pipe <- stressshift::stress_shift_unamb %>% dplyr::filter(Dict %in% c("W1802", "J1917", "C1687"))
identical(stress_shift_3dict, stress_shift_3dict_using_pipe)
```

## Task C

```{r}
stress_shift_3dict_nouns <- stress_shift_3dict %>% dplyr::filter(Category == "Noun")
#print(stress_shift_3dict_nouns)
stress_shift_3dict_verbs <- stress_shift_3dict %>% dplyr::filter(Category == "Verb")
#print(stress_shift_3dict_verbs)
stress_shift_3dict_using_bind <- dplyr::bind_rows(stress_shift_3dict_nouns, stress_shift_3dict_verbs)
#print(stress_shift_3dict_using_bind)
stress_shift_3dict_using_bind_reversed <- dplyr::bind_rows(stress_shift_3dict_verbs, stress_shift_3dict_nouns)
#print(stress_shift_3dict_using_bind_reversed)
identical(stress_shift_3dict, stress_shift_3dict_using_bind)
identical(stress_shift_3dict, stress_shift_3dict_using_bind_reversed)
```


## Task D

```{r}
stress_shift_nouns_renamed <- stressshift::stress_shift_unamb %>% 
  dplyr::filter(Category == "Noun") %>%
  dplyr::select(Word, Dict, Syllable) %>%
  dplyr::rename(Syllable_Noun = Syllable)
#print(stress_shift_nouns_renamed)

stress_shift_verbs_renamed <- stressshift::stress_shift_unamb %>% 
  dplyr::filter(Category == "Verb") %>%
  dplyr::select(Word, Dict, Syllable) %>%
  dplyr::rename(Syllable_Verb = Syllable)
#print(stress_shift_verbs_renamed)

stress_shift_wide <- dplyr::inner_join(stress_shift_nouns_renamed, stress_shift_verbs_renamed)
print(stress_shift_wide)
```

inner_join(x, y) "return all rows from x where there are matching values in y, and all columns from x and y. If there are multiple matches between x and y, all combination of the matches are returned." Therefore, it only returns the rows that are shared by both tables. That's the reason why it has fewer rows than the original tables.

## Task E

```{r}
ggplot2::ggplot(stressshift::stress_shift_unamb, ggplot2::aes(x=Category, fill=Syllable)) +
ggplot2::geom_bar(position="dodge", colour="black") + ggplot2::scale_fill_brewer(palette="Set3")
```

## Task F


```{r}
stress_shift_byword <- stress_shift_wide %>%
  dplyr::group_by(Word) %>%
  dplyr::summarise(Noun_Percent_Syll_1 = (sum(Syllable_Noun =="Syllable 1"))/n(),
                   Verb_Percent_Syll_1 = (sum(Syllable_Verb =="Syllable 1"))/n())
#print(stress_shift_byword)
print(dim(stress_shift_byword))
```


## Task G

```{r}
ggplot2::ggplot(stress_shift_byword, ggplot2::aes(x=Noun_Percent_Syll_1, y=Verb_Percent_Syll_1)) + ggplot2::geom_point()
```


## Task H


```{r}
stress_shift_nouns_renamed <- stressshift::stress_shift_unamb %>% 
  dplyr::filter(Category == "Noun") %>%
  dplyr::select(Word, Dict, Syllable) %>%
  dplyr::rename(Syllable_Noun = Syllable)
#print(stress_shift_nouns_renamed)

stress_shift_verbs_renamed <- stressshift::stress_shift_unamb %>% 
  dplyr::filter(Category == "Verb") %>%
  dplyr::select(Word, Dict, Syllable) %>%
  dplyr::rename(Syllable_Verb = Syllable)
#print(stress_shift_verbs_renamed)

stress_shift_wide_all <- dplyr::left_join(stress_shift_nouns_renamed, stress_shift_verbs_renamed)
#print(dim(stress_shift_wide_all)) 

stress_shift_byword_all <- stress_shift_wide_all %>%
  dplyr::group_by(Word) %>%
  dplyr::summarise(Noun_Percent_Syll_1 = (sum(Syllable_Noun =="Syllable 1"))/n(),
                   Verb_Percent_Syll_1 = (sum(Syllable_Verb =="Syllable 1"))/n())
print(stress_shift_byword_all)
print(dim(stress_shift_byword_all))
```


# Excercise 2

## Task A

Insert a chunk that uses this function to calculate the observed value of the test statistic. If you use "Syllable 1" as the target value, with nouns as group 1 and verbs as group 2, the result should be `0.6839201`.

```{r}
dif <- difference_in_proportion(stressshift::stress_shift_unamb, "Syllable", "Category", "Noun", "Verb", "Syllable 1")
print(dif)
```


## Task B

























